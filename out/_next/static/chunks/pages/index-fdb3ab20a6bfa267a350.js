(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{4223:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return x}});var r=n(5944),a=n(3843),o=n(6265),i=n(4671),s=n(5779);function c(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d={p:"https://raw.githubusercontent.com/cse412-21sp/us-gun-violence/main/data/perpetrators.csv",g:"https://raw.githubusercontent.com/cse412-21sp/us-gun-violence/main/data/guns.csv",pst:"https://raw.githubusercontent.com/cse412-21sp/us-gun-violence/main/data/perpetrators_by_state.csv",stp:"https://raw.githubusercontent.com/cse412-21sp/us-gun-violence/main/data/state_pop.csv",stf:"https://raw.githubusercontent.com/cse412-21sp/us-gun-violence/main/data/state_fips.csv",ppst:"https://raw.githubusercontent.com/cse412-21sp/us-gun-violence/main/data/perpetrators_by_state.csv"},p={usa:"https://raw.githubusercontent.com/vega/vega-datasets/master/data/us-10m.json"},m=(0,i.Z)((function(e,t){return{dataset:{},loadDataSet:function(n){fetch(d[n]).then((function(e){return e.text()})).then((function(r){var a=t().dataset;r=(0,s.CO)(r),e({dataset:f(f({},a),{},(0,o.Z)({},n,r))})}))},loadDataSets:function(e){var n,r=c(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;t().loadDataSet(a)}}catch(o){r.e(o)}finally{r.f()}},loadjson:function(n){fetch(p[n]).then((function(e){return e.json()})).then((function(r){var a=t().dataset;e({dataset:f(f({},a),{},(0,o.Z)({},n,r))})}))}}})),g=n(7294),h=n(9444),v=n(537),y=n(3640),_=n(3064),b=function(e){var t=e.func,n=e.name,a=(e.width,e.height,e.options),o=m((function(e){return e.dataset})),i={config:{},init:function(e){e.tooltip((new _.RW).call)},view:{renderer:"canvas"}};return v.z2l(h,y,i),(0,g.useEffect)((function(){t({dataSet:o,options:a}).render().then((function(e){document.getElementById(n).appendChild(e)}))}),[]),(0,r.tZ)("div",{id:n})};var w={config:{},init:function(e){e.tooltip((new _.RW).call)},view:{renderer:"canvas"}};v.z2l(h,y,w);var S=function(e){var t=e.dataSet,n=(e.options,t.p),r=v.Uk0().encodings("x"),a=v.x().yearmonth("date"),o=n.filter((function(e){return"Subject-Suspect"===e.type})).derive({month:function(e){return s.op.utcmonth(e.date)},is_male:function(e){return"Male"===e.gender},is_female:function(e){return"Female"===e.gender}}).groupby(["month","year"]).rollup({female_pctg:function(e){return 100*s.op.sum(e.is_female)/(s.op.sum(e.is_female)+s.op.sum(e.is_male))},male_pctg:function(e){return 100*s.op.sum(e.is_male)/(s.op.sum(e.is_female)+s.op.sum(e.is_male))},date:function(e){return s.op.min(s.op.utcdatetime(e.date))}}).derive({date:function(e){return s.op.datetime(e.year,e.month)}}).rename({male_pctg:"male",female_pctg:"female"}).fold(["female","male"]).rename({key:"gender"}),i=n.filter((function(e){return"Subject-Suspect"===e.type})).derive({month:function(e){return s.op.utcmonth(e.date)},is_male:function(e){return"Male"===e.gender},is_female:function(e){return"Female"===e.gender}}).groupby(["month","year"]).rollup({female_count:function(e){return s.op.sum(e.is_female)},male_count:function(e){return s.op.sum(e.is_male)},date:function(e){return s.op.min(s.op.utcdatetime(e.date))}}).derive({date:function(e){return s.op.datetime(e.year,e.month)}}).rename({male_count:"male",female_count:"female"}).fold(["female","male"]).rename({key:"gender"});return v.H7P(v.b59({opacity:.5}).data(i).encode(a,v.y().fieldQ("value").title("Number of perpetrators"),v.$_Y().fieldN("gender").scale({scheme:"set1"})).params(r),v.b59({opacity:.5}).data(o).encode(a,v.y().fieldQ("value").title("Percentage of perpetrators"),v.$_Y().fieldN("gender").scale({scheme:"set1"})).encode(a.scale({domain:r})))};var O={config:{},init:function(e){e.tooltip((new _.RW).call)},view:{renderer:"canvas"}};v.z2l(h,y,O);var j=function(e){var t=e.dataSet,n=e.options,r=t.pst,a=n.field,o=n.yearStart,i=n.yearEnd,s=n.scheme;return v.HG8().data(r).transform(v.hXT('datum["year"] >= '+o+' && datum["year"] <= '+i)).encode(v.y().fieldN("state").sort(v.J69(a).order("descending")).title("State"),v.$_Y().mean(a).scale({scheme:s}),v.MdO([v.tvR("state"),v.J69(a)]))};var E={config:{},init:function(e){e.tooltip((new _.RW).call)},view:{renderer:"canvas"}};v.z2l(h,y,E);var P=function(e){var t=e.dataSet,n=e.options,r=n.field,a=n.yearStart,o=n.yearEnd,i=n.scheme,s=t.pst,c=t.usa,u=t.ppst;return v.aTG(s).layer(v._fs({fill:"#ddd",stroke:"#fff",strokeWidth:1}).data(v.t_h(c).feature("states")).transform(v.P58("id").from(v.aTG(u).key("fip").fields("state"))).encode(v.MdO("state")),v.y$q({stroke:"#5e5e5e"}).data(s).transform(v.hXT('datum["year"] >= '+a+' && datum["year"] <= '+o),v.tqE("state").aggregate(v.J69("mean_age").as("mean_age"),v.J69("underages_ratio").as("underages_ratio"),v.J69("perpetrators_per_1M").as("perpetrators_per_1M"),v.J69("latitude").as("latitude"),v.J69("longitude").as("longitude"))).encode(v.pqJ().fieldQ("latitude"),v.MSO().fieldQ("longitude"),v.$_Y().mean(r).legend({titleLineHeight:10}).scale({scheme:i}).title({mean_age:"Perpetrators mean age",underages_ratio:["Ratio of underage/total","perpetrators"]}[r]),v.dpJ().mean("perpetrators_per_1M").title(["Perpetrators per","1M population"]),v.MdO([v.tvR("state"),v.xiU(r),v.xiU("perpetrators_per_1M")]))).project(v.CJN("albersUsa"))};var k={config:{},init:function(e){e.tooltip((new _.RW).call)},view:{renderer:"canvas"}};v.z2l(h,y,k);var M=function(e){var t=e.dataSet,n=e.options;return v.H7P(j({dataSet:t,options:n}).height(500),P({dataSet:t,options:n}).height(500).width(720)).config({scale:{maxSize:1500},view:{stroke:null}})};var N={name:"7dlj0d",styles:"width:100vw;height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center"},Z={name:"1n9bfnh",styles:"padding-top:16rem"},J={name:"czikf7",styles:'font-size:1.5rem;line-height:2rem;font-family:ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'},x=function(){var e=m((function(e){return e.dataset})),t=m((function(e){return e.loadDataSet})),n=m((function(e){return e.loadjson}));return console.log(e),(0,g.useEffect)((function(){t("p"),t("ppst"),n("usa")}),[]),e.p&&e.usa&&e.ppst?(0,r.BX)("main",{children:[(0,r.tZ)("section",{children:(0,r.tZ)(b,{func:S,name:"perpetratorsByGender"})}),(0,r.tZ)("section",{children:(0,r.tZ)(b,{func:M,name:"mapMeanAgeOfPerpetrators",options:{field:"mean_age",yearStart:2013,yearEnd:2018,schema:"goldred"}})})]}):(0,r.BX)("main",{css:N,children:[(0,r.tZ)("section",{children:(0,r.tZ)(a.X1,{size:"large"})}),(0,r.tZ)("section",{css:Z,children:(0,r.tZ)("h1",{css:J,children:"We are loading necessary files"})})]})}},8581:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4223)}])}},function(e){e.O(0,[774,880,980,888,179],(function(){return t=8581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);