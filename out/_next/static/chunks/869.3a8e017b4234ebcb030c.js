(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{5869:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var n=a(5944),r=a(9444),o=a(537),i=a(3640),l=a(3064),d=a(5779);var c={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,c);var u=function(e){var t=e.dataSet,a=(e.options,t.p),n=o.Uk0().encodings("x"),r=o.x().yearmonth("date"),i=a.filter((function(e){return"Subject-Suspect"===e.type})).derive({month:function(e){return d.op.utcmonth(e.date)},is_male:function(e){return"Male"===e.gender},is_female:function(e){return"Female"===e.gender}}).groupby(["month","year"]).rollup({female_pctg:function(e){return 100*d.op.sum(e.is_female)/(d.op.sum(e.is_female)+d.op.sum(e.is_male))},male_pctg:function(e){return 100*d.op.sum(e.is_male)/(d.op.sum(e.is_female)+d.op.sum(e.is_male))},date:function(e){return d.op.min(d.op.utcdatetime(e.date))}}).derive({date:function(e){return d.op.datetime(e.year,e.month)}}).rename({male_pctg:"male",female_pctg:"female"}).fold(["female","male"]).rename({key:"gender"}),l=a.filter((function(e){return"Subject-Suspect"===e.type})).derive({month:function(e){return d.op.utcmonth(e.date)},is_male:function(e){return"Male"===e.gender},is_female:function(e){return"Female"===e.gender}}).groupby(["month","year"]).rollup({female_count:function(e){return d.op.sum(e.is_female)},male_count:function(e){return d.op.sum(e.is_male)},date:function(e){return d.op.min(d.op.utcdatetime(e.date))}}).derive({date:function(e){return d.op.datetime(e.year,e.month)}}).rename({male_count:"male",female_count:"female"}).fold(["female","male"]).rename({key:"gender"});return o.H7P(o.b59({opacity:.5}).data(l).encode(r,o.y().fieldQ("value").title("Number of perpetrators"),o.$_Y().fieldN("gender").scale({scheme:"set1"})).params(n),o.b59({opacity:.5}).data(i).encode(r,o.y().fieldQ("value").title("Percentage of perpetrators"),o.$_Y().fieldN("gender").scale({scheme:"set1"})).encode(r.scale({domain:n})))};var s={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,s);var f=function(e){var t=e.dataSet,a=e.options,n=t.pst,r=a.field,i=a.yearStart,l=a.yearEnd,d=a.scheme;return o.HG8().data(n).transform(o.hXT('datum["year"] >= '+i+' && datum["year"] <= '+l)).encode(o.y().fieldN("state").sort(o.J69(r).order("descending")).title("State"),o.$_Y().mean(r).scale({scheme:d}),o.MdO([o.tvR("state"),o.J69(r)]))};var m={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,m);var p=function(e){var t=e.dataSet,a=e.options,n=a.field,r=a.yearStart,i=a.yearEnd,l=a.scheme,d=t.pst,c=t.usa,u=t.ppst;return o.aTG(d).layer(o._fs({fill:"#ddd",stroke:"#fff",strokeWidth:1}).data(o.t_h(c).feature("states")).transform(o.P58("id").from(o.aTG(u).key("fip").fields("state"))).encode(o.MdO("state")),o.y$q({stroke:"#5e5e5e"}).data(d).transform(o.hXT('datum["year"] >= '+r+' && datum["year"] <= '+i),o.tqE("state").aggregate(o.J69("mean_age").as("mean_age"),o.J69("underages_ratio").as("underages_ratio"),o.J69("perpetrators_per_1M").as("perpetrators_per_1M"),o.J69("latitude").as("latitude"),o.J69("longitude").as("longitude"))).encode(o.pqJ().fieldQ("latitude"),o.MSO().fieldQ("longitude"),o.$_Y().mean(n).legend({titleLineHeight:10}).scale({scheme:l}).title({mean_age:"Perpetrators mean age",underages_ratio:["Ratio of underage/total","perpetrators"]}[n]),o.dpJ().mean("perpetrators_per_1M").title(["Perpetrators per","1M population"]),o.MdO([o.tvR("state"),o.xiU(n),o.xiU("perpetrators_per_1M")]))).project(o.CJN("albersUsa"))};var g={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,g);var y=function(e){var t=e.dataSet,a=e.options;return o.H7P(f({dataSet:t,options:a}).height(500),p({dataSet:t,options:a}).height(500).width(720)).config({scale:{maxSize:1500},view:{stroke:null}})};var v={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,v);var _=function(e){var t=e.dataSet,a=e.options,n=t.p,r=a.yearStart,i=a.yearEnd,l=a.color;return o.ZtJ({opacity:.5}).data(n.params({yearStart:r,yearEnd:i}).filter((function(e){return"Subject-Suspect"===e.type})).filter((function(e){return op.year(e.date)>=r&&op.year(e.date)<=i}))).encode(o.x().fieldQ("age").scale({domain:[0,100]}).bin({step:5}),o.y().count().title("Number of Perpetrators"),o.$_Y().value(l))};var h={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,h);var w=function(e){var t=e.dataSet,a=(e.options,t.g);return o.b59({opacity:.8}).data(a).transform(o.hXT("datum['gun'] != 'Unknown'")).encode(o.x().yearmonth("date"),o.y().count().title("Number of guns"),o.$_Y().fieldN("gun").scale({scheme:"category20b"}).title("Gun type")).height(400).width(700)};var S={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,S);var b=function(e){var t=e.dataSet,a=e.options,n=a.yearStart,r=a.yearEnd,i=t.g;return o.ZtJ({opacity:.8}).data(i).transform(o.hXT("datum['gun'] != 'Unknown' && datum['year'] >= "+n+" && datum['year'] <= "+r)).encode(o.y().fieldN("gun").sort(o.QXW()),o.x().count().title("Number of guns"),o.$_Y().fieldN("gun").scale({scheme:"category20b"}).legend(!1).title("Gun type"))};var k={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,k);var Z=function(e){var t=e.dataSet,a=e.options,n=a.yearStart,r=a.yearEnd,i=t.g;return o.ZtJ({opacity:.8}).data(i).transform(o.hXT("datum['gun'] != 'Unknown' && datum['year'] >= "+n+" && datum['year'] <= "+r)).encode(o.y().fieldN("gun").sort(o.J69("n_killed")),o.x().mean("n_killed").title("Mean kill counts in an incident"),o.$_Y().fieldN("gun").scale({scheme:"category20b"}).legend(!1).title("Gun type"))};var N={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,N);var J=function(e){var t=e.dataSet,a=e.options;return o.H7P(b({dataSet:t,options:a}),Z({dataSet:t,options:a}))};var R={config:{},init:function(e){e.tooltip((new l.RW).call)},view:{renderer:"canvas"}};o.z2l(r,i,R);var W=function(e){var t=e.dataSet,a=e.options,n=a.field,r=a.state_abbr,i=a.color,l=t.pst,d={mean_age:"Perpetrators mean age",underages_ratio:["Ratio of underage/total","perpetrators"]};return o.EY_(o.fpH().data(l).encode(o.x().fieldO("year"),o.y().mean(n).title(d[n]),o.$_Y().value("orange")),o.fpH().data(l).transform(o.hXT('datum["state_abbr"] == "'+r+'"')).encode(o.x().fieldO("year"),o.y().mean(n).title(d[n]),o.$_Y().value(i))).width(500)},x=a(5152);var E=function(e){return(0,n.tZ)("section",{children:e.children})},M=(0,x.default)((function(){return a.e(808).then(a.bind(a,4808))}),{ssr:!1,loadableGenerated:{webpack:function(){return[4808]},modules:["../components/Vis.js -> ./VegaComp"]}}),z={name:"27vez",styles:"width:100vw;display:flex;flex-direction:column;justify-content:center;align-items:center"},T=function(){return(0,n.BX)("main",{css:z,children:[(0,n.tZ)(E,{children:(0,n.tZ)(M,{func:u,name:"perpetratorsByGender"})}),(0,n.tZ)(E,{children:(0,n.tZ)(M,{func:_,options:{yearStart:2013,yearEnd:2018,color:"teal"},name:"ageHistogram"})}),(0,n.tZ)(E,{children:(0,n.tZ)(M,{func:w,name:"gunArea"})}),(0,n.tZ)(E,{children:(0,n.tZ)(M,{func:J,name:"numGunByTypes",options:{yearStart:2013,yearEnd:2018}})}),(0,n.tZ)(E,{children:(0,n.tZ)(M,{func:y,name:"mapMeanAgeOfPerpetrators",options:{field:"mean_age",yearStart:2013,yearEnd:2018,schema:"goldred"}})}),(0,n.tZ)(E,{children:(0,n.tZ)(M,{func:W,options:{field:"mean_age",state_abbr:"WA",color:"red"},name:"perpetratorsByTime"})}),(0,n.tZ)(E,{children:(0,n.tZ)(M,{func:W,name:"perpetratorsByTime",options:{field:"underages_ratio",state_abbr:"WA",color:"red"}})})]})}}}]);